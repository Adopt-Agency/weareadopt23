<script setup>
const props = defineProps(['header'])
const showMenu = ref(false)
const root = ref(null)
const targetZone = ref(null)
const currentYear = new Date().getFullYear()
const route = useRoute()
const headRef = ref(null)
const scrolled = ref(false)
const lastPosition = ref(null)

const isHome = computed(() => {
  return route.path === '/' || route.path === '/home'
})

const cartVal = computed({
  get: () => {
    return useCart().linesCount.value
  },
})

const currentPath = computed({
  get() {
    console.log(route.path)
  },
})

onMounted(() => {
  window.addEventListener('scroll', () => {
    const currentScrollPos = window.scrollY
    const limitPosition = 50

    if (lastPosition.value < currentScrollPos && limitPosition < currentScrollPos)
      scrolled.value = true

    if (lastPosition.value > window.scrollY)
      scrolled.value = false
      // move down
    lastPosition.value = currentScrollPos
    // move down
  })
})
onUnmounted(() => {
  window.removeEventListener('scroll')
})

defineExpose({
  scrolled, lastPosition,
})
</script>

<template>
  <header
    class="site-header" :class="{ ' scroll': scrolled, 'text-white  mix-blend-difference': isHome, 'menuOpen': showMenu }"
  >
    <div class=" top-0 px-0 md:px-8 py-[1.75rem] bg-transparent wrapper">
      <div class="md:block hidden w-[calc(50%-70px)] md:w-[calc(52%-100px)]">
        <NuxtLink :to="{ path: '/', hash: `#studio` }" class="text-inherit">
          Studio
        </NuxtLink>
      </div>
      <button
        class="w-[25px] h-[25px] mr-auto block relative left-[1rem] hamburger md:hidden"
        aria-label="Mobile Menu"
        @click.prevent="showMenu = true"
      >
        <div>
          <span class="hamburger_line" />
          <span class="my-1 hamburger_line" />
          <span class="hamburger_line" />
        </div>
      </button>
      <transition name="adoptMenu">
        <div
          v-show="showMenu"
          class="fixed top-0 z-[1000] left-0 w-full  text-md mobile-menu adoptMenu overlay bg-neon"
        >
          <div class="container p-4">
            <div class="flex justify-between pt-[.75rem]">
              <button @click.prevent="showMenu = false">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="26"
                  height="27"
                  viewBox="0 0 26 27"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  class="feather feather-x"
                >
                  <line x1="18" y1="6" x2="6" y2="18" />
                  <line x1="6" y1="6" x2="18" y2="18" />
                </svg>
              </button>
              <div>
                <NuxtLink to="/cart" class="no-underline md:pr-6">
                  <span class="pr-1">Bag</span>
                  <span v-if="cartVal >= 1">( {{ cartVal }} )</span>
                  <span v-else>( 0 )</span>
                </NuxtLink>
              </div>
            </div>
            <div class="mobile-content">
              <ul class="pt-10 pb-4 menu-list">
                <li>
                  <NuxtLink :to="{ path: '/', hash: `#studio` }" class="text-inherit" @click.prevent="showMenu = false">
                    Studio
                  </NuxtLink>
                </li>
                <li>
                  <NuxtLink to="/products" @click.prevent="showMenu = false">
                    Shop
                  </NuxtLink>
                </li>
              </ul>

              <ul class="pb-4 menu-list">
                <li>
                  <a target="_blank" href="mailto:hello@weareadopt.com">hello@weareadopt.com </a>
                </li>
                <li>
                  <a
                    class="block md:inline"
                    href="https://www.instagram.com/adopt/"
                    target="_blank"
                    rel="noopener noreferrer"
                  >
                    Instagram</a>
                </li>
                <li>
                  <a
                    class="block md:inline"
                    href="https://www.linkedin.com/company/weareadopt/"
                    target="_blank"
                    rel="noopener noreferrer"
                  >LinkedIn</a>
                </li>
              </ul>

              <ul class="pb-4 menu-list">
                <li>
                  <NuxtLink
                    to="/privacy-policy"
                    @click.prevent="showMenu = false"
                  >
                    Privacy
                  </NuxtLink>
                </li>
                <li>
                  <NuxtLink
                    to="/terms-of-service"
                    @click.prevent="showMenu = false"
                  >
                    Terms of Service
                  </NuxtLink>
                </li>
              </ul>

              <p>Â©Adopt {{ currentYear }}</p>
            </div>
          </div>
        </div>
      </transition>
      <NuxtLink
        to="/" :class=" cartVal ? '' : 'ml-[-40px]' "
        class="mr-auto no-underline md:ml-auto"
      >
        <svg
          viewBox="0 0 107 38"
          fill="currentColor"
          class=" w-16 xl:w-[4.5rem] mx-auto min-[1900px]:w-20 text-inherit"
          xmlns="http://www.w3.org/2000/svg"
        >
          <g clip-path="url(#clip0_1_115)">
            <path
              d="M26.4926 27.6192C26.198 27.3813 25.9418 27.0738 25.7233 26.6966C25.5049 26.3201 25.2701 25.8431 25.0197 25.2671L15.1201 1.34619L14.3346 1.57875L6.2019 21.6099C5.79809 22.5744 5.44076 23.3995 5.12991 24.0866C4.81906 24.7736 4.52157 25.3609 4.23803 25.8485C3.9539 26.336 3.67094 26.7326 3.3874 27.0372C3.10386 27.3424 2.80114 27.5885 2.47925 27.7768C2.15736 27.9657 1.79422 28.115 1.39098 28.226C0.987169 28.3369 0.523507 28.4308 0 28.5087V28.9909H10.0146V28.5087C9.40338 28.442 8.85024 28.3564 8.35404 28.2513C7.85784 28.1463 7.44298 27.9828 7.11063 27.7609C6.7777 27.5395 6.51334 27.268 6.31695 26.9463C6.12056 26.6252 6.01656 26.2203 6.0061 25.7328C5.99506 25.2452 6.07408 24.6632 6.24316 23.9874C6.41224 23.3116 6.67661 22.5248 7.03684 21.627L8.17276 18.7844H16.736L19.3093 25.3172C19.5383 25.8827 19.6829 26.3508 19.7434 26.722C19.8032 27.0933 19.7405 27.3925 19.5551 27.6198C19.3698 27.847 19.0671 28.0271 18.647 28.1605C18.2269 28.2933 17.6679 28.4095 16.9695 28.5093V28.9915H29.0131V28.5093C28.4239 28.4095 27.9301 28.2956 27.5321 28.1681C27.1341 28.0406 26.7872 27.8582 26.4932 27.6198L26.4926 27.6192ZM8.51033 17.9362L12.4834 7.99176L16.4007 17.9362H8.50975H8.51033Z"
            />
            <path
              d="M47.9564 26.5304C47.76 26.3639 47.6234 26.1396 47.5473 25.8569C47.4706 25.5742 47.4329 25.1946 47.4329 24.7183V0H47.0238C46.5108 0.354738 45.9849 0.659304 45.4452 0.91429C44.9048 1.16928 44.3488 1.40478 43.7759 1.62081C43.203 1.83684 42.6086 2.02808 41.9927 2.19394C41.3762 2.36039 40.7185 2.52625 40.0207 2.6927V3.12476C40.5773 3.25756 41.0212 3.38801 41.3547 3.5155C41.6871 3.64299 41.9491 3.80118 42.1403 3.98888C42.3308 4.17717 42.4511 4.42389 42.5005 4.72846C42.5493 5.03361 42.5743 5.43498 42.5743 5.93374V11.5694C42.3123 11.5027 42.0368 11.4502 41.7475 11.4112C41.4581 11.3728 41.167 11.3368 40.8725 11.3032C40.5779 11.2701 40.2752 11.2424 39.9643 11.22C39.6535 11.1981 39.3507 11.1869 39.0562 11.1869C38.1829 11.1869 37.3131 11.2843 36.4462 11.4779C35.5787 11.6721 34.7496 11.9489 33.9588 12.309C33.168 12.669 32.426 13.1294 31.7335 13.6884C31.0403 14.2479 30.4407 14.8937 29.9334 15.625C29.4262 16.3563 29.0305 17.1738 28.747 18.0769C28.4628 18.9799 28.3217 19.9751 28.3217 21.0605C28.3217 22.313 28.518 23.454 28.9108 24.4852C29.3036 25.5157 29.8544 26.3999 30.5633 27.1365C31.2721 27.8737 32.1204 28.4386 33.1082 28.8323C34.0953 29.2254 35.1668 29.4226 36.3236 29.4226C37.0435 29.4226 37.7035 29.3364 38.3037 29.1646C38.9034 28.9929 39.4577 28.7686 39.9649 28.4911C40.4721 28.2143 40.941 27.8873 41.3721 27.5107C41.8033 27.1342 42.2042 26.7293 42.5749 26.2972L42.7707 29.4054C43.2832 29.2171 43.845 29.023 44.4563 28.8235C45.0669 28.624 45.6997 28.4469 46.3545 28.2916C47.0093 28.1364 47.6577 27.9983 48.3015 27.8761C48.9453 27.7545 49.5397 27.6548 50.0853 27.5769V27.0946C49.5501 27.0504 49.1115 26.9866 48.7681 26.9034C48.4241 26.8202 48.1539 26.6956 47.9581 26.5298L47.9564 26.5304ZM42.5731 25.6656C42.3767 25.8651 42.1531 26.0345 41.902 26.1727C41.651 26.3114 41.3867 26.4194 41.1084 26.4967C40.8301 26.574 40.5494 26.6325 40.2659 26.6708C39.9817 26.7098 39.7092 26.7293 39.4478 26.7293C38.5861 26.7293 37.7895 26.5522 37.0586 26.1975C36.3277 25.8427 35.6868 25.3363 35.136 24.6764C34.5851 24.0171 34.1482 23.2025 33.8269 22.2328C33.505 21.263 33.3441 20.1634 33.3441 18.9333C33.3441 17.7918 33.4696 16.7748 33.7206 15.8829C33.9716 14.9911 34.326 14.2485 34.7844 13.6553C35.2429 13.0627 35.8012 12.6106 36.4619 12.3007C37.1219 11.9908 37.85 11.835 38.646 11.835C39.2462 11.835 39.7917 11.9377 40.2821 12.1425C40.7731 12.3479 41.1903 12.6496 41.5337 13.0486C41.8771 13.4476 42.1362 13.9381 42.3111 14.52C42.4854 15.102 42.5731 15.7749 42.5731 16.5393V25.6656Z"
            />
            <path
              d="M90.2571 13.4481C89.5477 12.728 88.7023 12.1708 87.7203 11.7771C86.739 11.384 85.6641 11.1869 84.4968 11.1869C83.7873 11.1869 83.1325 11.2677 82.5329 11.4283C81.9327 11.5888 81.3767 11.8137 80.8642 12.1012C80.3511 12.3892 79.8764 12.7191 79.4407 13.0904C79.0043 13.4617 78.6005 13.863 78.2298 14.2957V10.7383H77.8039C77.3025 11.0706 76.7784 11.3728 76.2334 11.6443C75.6878 11.9158 75.1312 12.1625 74.5641 12.3839C73.9964 12.6058 73.402 12.8024 72.7803 12.9741C72.1586 13.1459 71.5038 13.3094 70.817 13.4646V13.8802C71.3731 14.0242 71.8176 14.1576 72.1505 14.2792C72.4828 14.4013 72.7449 14.5589 72.9361 14.7531C73.1266 14.9473 73.244 15.1994 73.2876 15.5092C73.3311 15.8197 73.3532 16.2134 73.3532 16.6897V34.8752C73.3532 35.3739 73.3126 35.7783 73.2306 36.0887C73.1487 36.3992 73.0069 36.6483 72.8053 36.8366C72.6031 37.0249 72.3329 37.1665 71.9948 37.261C71.6566 37.3548 71.2313 37.441 70.7183 37.5189V38.0005H81.6654V37.5189C80.9781 37.4416 80.4139 37.3495 79.9717 37.2444C79.5301 37.1394 79.1751 36.9924 78.9084 36.8041C78.6412 36.6158 78.4611 36.3661 78.3687 36.0563C78.2757 35.7458 78.2292 35.3415 78.2292 34.8427V28.9916C78.4913 29.0802 78.769 29.1492 79.0636 29.1994C79.3582 29.249 79.6469 29.2932 79.9305 29.3322C80.214 29.3706 80.5138 29.3959 80.8305 29.4072C81.1472 29.4184 81.4632 29.4237 81.7793 29.4237C82.641 29.4237 83.5032 29.3263 84.3649 29.1327C85.2266 28.9391 86.0557 28.6534 86.8523 28.2762C87.6483 27.8997 88.3903 27.4369 89.0776 26.8886C89.765 26.3402 90.3594 25.7028 90.8614 24.9768C91.3628 24.2508 91.7591 23.4333 92.0478 22.5249C92.3366 21.6165 92.4813 20.6302 92.4813 19.566C92.4813 18.3029 92.2872 17.1478 91.9003 16.1001C91.5127 15.053 90.9648 14.1694 90.2559 13.4487L90.2571 13.4481ZM87.0905 24.7265C86.8343 25.6077 86.4711 26.3473 86.0022 26.9458C85.5333 27.5443 84.9715 27.9929 84.3173 28.2922C83.6624 28.5914 82.9478 28.7408 82.1733 28.7408C81.5626 28.7408 81.017 28.644 80.5371 28.4498C80.0566 28.2562 79.6452 27.9593 79.3012 27.5603C78.9573 27.1613 78.6929 26.6684 78.5075 26.0811C78.3222 25.4938 78.2298 24.8068 78.2298 24.02V14.9273C78.4372 14.739 78.6714 14.5755 78.9334 14.4368C79.1955 14.2986 79.4598 14.19 79.7265 14.1127C79.9944 14.0354 80.264 13.977 80.5371 13.9386C80.809 13.8996 81.0873 13.8802 81.3714 13.8802C82.2325 13.8802 83.0372 14.0578 83.785 14.412C84.5322 14.7667 85.1731 15.2737 85.7076 15.933C86.2416 16.5929 86.6698 17.4045 86.9923 18.3684C87.3136 19.3323 87.4746 20.4295 87.4746 21.6596C87.4746 22.823 87.3462 23.8453 87.0899 24.7265H87.0905Z"
            />
            <path
              d="M106.706 25.9317C106.368 26.1867 106.059 26.3974 105.781 26.5633C105.503 26.7297 105.227 26.8625 104.955 26.9623C104.682 27.062 104.42 27.134 104.17 27.1783C103.919 27.2226 103.668 27.245 103.417 27.245C102.991 27.245 102.601 27.1812 102.247 27.0537C101.893 26.9263 101.598 26.735 101.363 26.48C101.128 26.225 100.946 25.898 100.815 25.4996C100.684 25.1006 100.619 24.6243 100.619 24.0701V12.467H106.706V11.669H100.619V7.41333H100.177C99.8713 8.14464 99.4983 8.77089 99.0562 9.29149C98.6146 9.81268 98.1073 10.2613 97.5339 10.6378C96.961 11.015 96.3154 11.3137 95.595 11.5356C94.8751 11.7575 94.0837 11.901 93.222 11.9677V12.4664H95.7751V24.8504C95.7751 25.6708 95.8954 26.3632 96.1347 26.928C96.3747 27.4935 96.71 27.9586 97.1417 28.3245C97.5722 28.6905 98.0853 28.9561 98.6802 29.1226C99.2746 29.289 99.9207 29.3716 100.619 29.3716C101.263 29.3716 101.882 29.2914 102.476 29.1308C103.07 28.9703 103.624 28.7513 104.137 28.4745C104.65 28.1976 105.144 27.8736 105.618 27.5023C106.093 27.1311 106.553 26.7515 107.001 26.3638L106.706 25.9317Z"
            />
            <path
              d="M60.4015 10.5652C55.1461 10.5652 50.8708 14.9082 50.8708 20.247C50.8708 25.5857 55.1461 29.9288 60.4015 29.9288C65.6569 29.9288 69.9315 25.5857 69.9315 20.247C69.9315 14.9082 65.6563 10.5652 60.4015 10.5652ZM64.808 24.4737C64.5977 25.4104 64.2996 26.1978 63.9115 26.8359C63.5239 27.4739 63.0393 27.9544 62.4583 28.2767C61.8767 28.599 61.1986 28.7495 60.4247 28.7288C59.8576 28.7135 59.3423 28.5942 58.8798 28.3711C58.4155 28.148 58.0036 27.8346 57.6433 27.4314C57.2831 27.0283 56.9682 26.5402 56.7003 25.9676C56.4307 25.3951 56.2163 24.757 56.0542 24.0547C55.8927 23.3523 55.7759 22.5979 55.7044 21.7922C55.633 20.9866 55.6086 20.1295 55.6324 19.2211C55.6638 18.0247 55.7846 16.9552 55.9949 16.0131C56.2047 15.0711 56.5062 14.2837 56.9002 13.6516C57.2935 13.0194 57.7775 12.5419 58.3533 12.2191C58.9291 11.8968 59.6043 11.7457 60.3788 11.7663C60.9569 11.7817 61.4746 11.9015 61.9325 12.1246C62.3909 12.3477 62.8029 12.6635 63.1689 13.0725C63.5344 13.4816 63.8493 13.9697 64.1119 14.5364C64.3757 15.1036 64.5884 15.7328 64.7505 16.4246C64.9126 17.1163 65.0282 17.876 65.0997 18.7041C65.1711 19.5316 65.195 20.3833 65.1723 21.2587C65.1409 22.4663 65.0195 23.5388 64.8097 24.4749L64.808 24.4737Z"
            />
          </g>
          <defs>
            <clipPath id="clip0_1_115">
              <rect width="107" height="38" fill="white" />
            </clipPath>
          </defs>
        </svg>
      </NuxtLink>
      <CartIcon />
    </div>
  </header>
</template>

<style scoped>
.site-header {
  @apply  top-[-7px]  fixed  w-full ease-in-out  duration-300 w-full z-50 ;
}

.site-header.scroll {
  transform: translateY(-100%);
}
.site-header {
  transition: transform 0.4s cubic-bezier(0, 0, 0.58, 1);
  transform: translateY(0%);

}

.site-header.show.true {
  @apply opacity-100;
  transition-delay: 1s;
  transform: translateY(0px);
}
.site-header > .wrapper {
  @apply flex items-center justify-between m-auto relative;
 ;
}

.site-logo {
  @apply font-black text-lg;

}

a.router-link-exact-active {
  @apply underline underline-offset-4	;
}

.hamburger_line {
  display: block;
  width: 100%;
  height: 2px;
  background: currentColor;
}

.mobile-menu {
  color: black;
  height:100vh;
}
.menuOpen {
  mix-blend-mode: normal !important;
}

.adoptMenu-enter{
transition:.3s ease;

}

.adoptMenu {
transition:.3s ease;
}

.adoptMenu-enter-active, .adoptMenu-leave-active{
transition:.2s ease;
opacity: 1;
}

.adoptMenu-enter-active {
opacity: 0;

}
.adoptMenu-leave-to {
opacity: 0;
transition:.4s ease;
}

.menu-list a{
  color: black;
}
</style>
